

# text embedding



## 1. 现有方案/矛盾：
1. 方案一，使用dictionary检索：
    - 具体过程：首先使用llm得到词语频率，然后对于句子进行分词，找到其中和预定义词典最相似的单词，作为该句子的类型
    - 优点：对于具体的类型直观可解释，xx裤子，xx裙子。
    - 缺点：dictionary的定义难以make sense，dictionary的定义不一定全面有代表性。根据dictionary分配类型的话，也会出现多对一的情况，即同一个句子和post可能同时match多个关键词。
2. 方案二，直接对于所有text进行聚类：
    - 具体过程：首先对于post全部text合并，然后直接进行embedding，进行cluster。
    - 优点：直接聚类，不需要任何预定义，而且也不会出现多对一的情况。
    - 缺点：句子的语气结构相似度可能带来干扰，两个句子只是结构和语气相似就会被cluster在一起。


# 2. 解决思路：
- 放弃方案一的dictionary。使用方案二的句子直接聚类，但注意使用[`分词技术`]和[`关键词提取`]两个方法，解决句子的语气和结构干扰问题。

具体来说:
1. 首先使用[`jieba`]分词，使得句子变为一些key words。
    - 根据语义自动分词，避免了手动的截取关键词。
2. 然后使用关键词提取技术[`RAKE`],得到这个句子中最重要的关键词。
    - 经过实验：RAKE对于单个句子的关键词提取的效果好于YAKE和TF-IDF等其他常见方法。
3. 对这些关键词当作一个句子，进行embedding和cluster
    - 这样零碎的关键词组成的sentence，会克服句子结构和语气的影响。


# 3. 举例： 

句子：'花卉连衣裙这样搭配真的好好看❤️ - 小红书,,05-17,,#白茶姐弟 #每日穿搭 #气质连衣裙 #连衣裙 #显瘦连衣裙'


0. 数据清洗：去掉语气词和无关词汇[`stopwords_cn.txt`]，表情包转化[`emoji`]
    - 得到：'花卉连衣裙 搭配真的好好看(爱心)   白茶姐弟  每日穿搭  气质连衣裙  连衣裙  显瘦连衣裙 '
1. 首先使用[`jieba`]分词，使得句子变为一些key words。
    - 得到：'花卉 连衣裙   搭配 真的 好好看 ( 爱心 )  白茶 姐弟  每日 穿 搭  气质 连衣裙  连衣裙   显瘦 连衣裙'
2. 然后使用关键词提取技术[`RAKE`],得到这个句子中最重要的关键词。
    - 得到：'白茶 姐弟 每日 穿 搭 气质 连衣裙 连衣裙 显瘦 连衣裙'
3. 对这些关键词当作一个句子，直接进行embedding和cluster
    - 使用text2vec-large-chinese，进行embedding


上述细节见代码：[`data.ipynb`](https://github.com/dengxw66/Multimodal_MKT/blob/dxw_devlop/label/text-cluster/data.ipynb)





















